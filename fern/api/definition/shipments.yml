# yaml-language-server: $schema=https://raw.githubusercontent.com/fern-api/fern/main/fern.schema.json

service:
  auth: true
  base-path: /v1/shipments
  endpoints:
    create:
      path: ""
      docs: Gets shipping rates for a new shipment.
      method: POST
      request:
        name: CreateShipmentRequest
        body:
          properties:
            sender: Sender
            recipient: Recipient
            parcel: Parcel
      response: ShipmentResponse
      examples:
        - request:
            sender: $Sender.Example1
            recipient: $Recipient.Example1
            parcel: $Parcel.Example1
          response:
            body:
              status: 200
              data: $Shipment.Example1
              message: You created a shipment
              errors: []
              events: [shipment.rates_generated, shipment.tracking_updated]
              endpoint: /

    list:
      docs: Lists shipments up to the specified limit starting at the specified page
      path: ""
      method: GET
      response: ShipmentResponse

    retrieve:
      docs: Retrieves a specific shipment
      method: GET
      path: /{shipment}
      path-parameters:
        shipment: string
      response: ShipmentResponse

    purchase:
      docs: Purchases a shipping label
      method: POST
      path: /{shipment}
      path-parameters:
        shipment: string
      request:
        name: PurchaseShippingLabelRequest
        body:
          properties:
            rate_id:
              type: string
              docs: The ID of the rate that you wish to purchase
            payment_method:
              type: optional<string>
              docs: The ID of the payment method that you want to use from the payment methods you have on file with PackageX. If not provided, we'll use the default payment method on file
            payment_reference:
              type: string
              docs: A reference to the payment that can be added to this shipment. This is a field generated by the user
            label_size: LabelSize
      response: ShipmentResponse
      examples:
        - path-parameters:
            shipment: ship_czhgjrk5JaVvyATPDbyURp
          request:
            rate_id: "rate_bdc2f190408545ec8a118886fd5e1dee"
            payment_reference: "Sandbox Department"
            label_size: "4x6"
          response:
            body:
              status: 200
              data: $Shipment.Example1
              message: You purchased a shipping label
              errors: []
              events: [shipment.purchase, shipment.tracking_updated]
              endpoint: /ship_czhgjrk5JaVvyATPDbyURp

types:
  Response:
    docs: An error response
    properties:
      status:
        docs: A 2XX code
        type: integer
      message:
        docs: A human readable message to display to an end user
        type: string
      error_code:
        type: optional<string>
        docs: The developer code for the issue that occurred.
      errors:
        docs: An list of errors that occurred. Normally will be of the properties that failed validation.
        type: list<string>
      pagination: optional<Pagination>
      events:
        docs: All of the events that were triggered due to this request
        type: list<string>
      endpoint:
        docs: The endpoint that was hit
        type: string

  LabelSize:
    docs: Specify a label size for the returned shipping label. If not included, we'll use the default shipping label size set from the PackageX Dashboard.
    enum:
      - name: "FOUR_BY_SIX"
        value: "4x6"
      - name: "letter"
        value: "letter"
      - name: "FOUR_BY_EIGHT"
        value: "4x8"
      - name: "a4"
        value: "a4"
      - name: "a6"
        value: "a6"

  Pagination:
    docs: The pagination object returned in responses where multiple values are returned
    properties:
      limit:
        type: integer
        docs: The limit for the responses
      page:
        type: integer
        docs: The current page offset that is being retrieved
      has_more:
        type: boolean
        docs: indicates if there are more values in the database not retrieved in this query

  ShipmentResponse:
    extends: Response
    properties:
      data: Shipment

  Address:
    docs: The PackageX address object
    properties:
      id:
        docs: The ID for this address. Can be passed into any address field in the future to retrieve this exact address.
        type: string
      hash:
        docs: Similar to the address ID, the hash is a unique string that identifies the address but without the line2 property.
        type: string
      line1:
        docs: The first line of the street address.
        type: string
      line2:
        docs: The second line of the street address.
        type: string
      city:
        docs: The name of the city.
        type: string
      state:
        docs: The full name of the state.
        type: string
      state_code:
        docs: The abbreviated code for the state if applicable.
        type: string
      country:
        docs: The full name of the country for this address.
        type: string
      country_code:
        docs: The two character country code for this address.
        type: string
      postal_code:
        docs: The postal code for this address.
        type: string
      formatted_address:
        docs: The full text string of the address.
        type: string
      textarea:
        docs: The full text string of the address without the line2 address. This is useful if using address auto complete that does not provide a line2 address which would be asked for in a separate input field.
        type: string
      timezone:
        docs: The timezone for this address
        type: string
      verified:
        docs: If we have verified this address
        type: boolean
    examples:
      - name: Example1
        value:
          id: defnewfed_93392
          hash: dac0efe_w9dw
          line1: 500 7th Ave
          line2: Fl 10
          city: New York
          state: New York
          state_code: NY
          country: United States
          country_code: US
          postal_code: "10018"
          formatted_address: 500 7th Ave, Fl 10, New York, NY, 10018
          textarea: 500 7th Ave
          timezone: EST
          verified: true
      - name: Example2
        value:
          id: fefewfe_9292
          hash: efneif_2921
          line1: 600 B. Street
          line2: Suite 300
          city: San Diego
          state: California
          state_code: CA
          country: United States
          country_code: US
          postal_code: "90101"
          formatted_address: 600 B. Street, Suite 300 7th Ave, Fl 10, San Diego, California 90101
          textarea: 600 B. Street
          timezone: PST
          verified: true

  Rate:
    docs: The shipping rate object showing the service level, price, and shipping provider information
    properties:
      id:
        docs: The ID for this rate. To purchase a shipping label after getting rates, you will pass in this rate to indicate you wish to purchase it
        type: string
      amount:
        docs: The amount that will be collected from a customer. This includes any upcharges or discounts you have added to the price on the PackageX Dashboard.
        type: integer
      billed_amount:
        docs: The amount that your organization will be billed for this rate.
        type: integer
      carrier_account:
        docs: The custom rate card that was used for this transaction. Should be null for all organizations currently.
        type: optional<string>
      pickup_at:
        docs: Time in epoch seconds when this shipment will be picked up, if that is included in the service of this rate. Will be null otherwise.
        type: optional<integer>
      provider: Provider
      service_level: ServiceLevel
    examples:
      - name: Example1
        value:
          id: dndine29dnc9
          amount: 1203
          billed_amount: 9023
          service_level: $ServiceLevel.Example1
          provider: $Provider.Example1

  ServiceLevel:
    docs: The service level for this rate
    properties:
      name:
        docs: The human readable name for this service label
        type: string
      id:
        docs: The unique ID of this provider's service level
        type: string
      terms:
        docs: The human readable delivery estimate for this rate
        type: string
      days:
        docs: The integer of days that this delivery is estimated to take if the provider receives the shipment before their daily cutoff time.
        type: integer
      estimated_delivery:
        docs: The time in epoch seconds when we estimate the shipment at this rate will be delivered
        type: integer
      pickup_at:
        docs: The time in epoch seconds when this shipment will be picked up for this rate
        type: integer
    examples:
      - name: Example1
        value:
          id: 3bicjss933jckjcsww
          name: Same Day
          days: 1
          estimated_delivery: 1679591515
          terms: "Today by 9pm"
          pickup_at: 1679591623

  Provider:
    docs: Details about a shipping provider for a given rate or shipment
    properties:
      name:
        docs: The name of the provider
        type: string
      id:
        docs: Unique ID of the provider
        type: string
      logo_url:
        docs: The url for the provider's logo
        type: string
      support_email:
        docs: The contact email provided by the shipping provider
        type: optional<string>
      support_phone:
        docs: The contact phone provided by the shipping provider
        type: optional<string>
      support_url:
        docs: The contact website provided by the shipping provider
        type: string
      support_reference:
        docs: A support reference code that some providers use to help customers.
        type: optional<string>
      marketplace:
        docs: If this shipping provider came from the PackageX marketplace. Typically large providers like FedEx, UPS, USPS, etc are not from the marketplace and same-day courier are not.
        type: boolean
    examples:
      - name: Example1
        value:
          name: UPS
          id: 2dij3dn9
          logo_url: "NA"
          support_email: support@ups.com
          support_phone: 1-800-742-5877
          support_url: https://www.ups.com/us/en/support/contact-us.page
          marketplace: false

  Attributes:
    docs: Indicates certain aspects of the item that will impact shipping and handling
    enum:
      - alcohol
      - marijuana
      - pharma
      - dry_ice
      - lithium

  PackageType:
    docs: The courier specific packaging. See https://docs.packagex.io/shipments/predefined-packages for more information
    enum:
      - usps_flat_rate_envelope
      - usps_flat_rate_window_envelope
      - usps_small_flat_rate_envelope
      - usps_flat_rate_padded_envelope
      - usps_flat_rate_legal_envelope
      - usps_small_flat_rate_box
      - usps_medium_flat_rate_box_1
      - usps_medium_flat_rate_box_2
      - usps_large_flat_rate_box_1
      - usps_large_flat_rate_box_2
      - usps_large_flat_rate_box_apo_fpo

  Parcel:
    docs: A parcel or package that will be included in a shipment
    properties:
      attributes: optional<list<Attributes>>
      id:
        docs: The unique ID assigned to the parcel beginning with prcl_
        type: string
      length:
        docs: The length of the package in inches
        type: integer
      width:
        docs: The width of the package in inches
        type: integer
      height:
        docs: The height of the package in inches
        type: integer
      weight:
        docs: The weight of the package in pounds
        type: integer
      type: PackageType
      special_handling:
        docs: Any special handing instructions provided. Not all shipping providers support these
        type: optional<string>
      tracking_number:
        docs: The tracking number for this parcel if a shipment was purchased
        type: optional<string>
      label_url:
        docs: The shipping label PDF for this parcel if a shipment was purchased
        type: optional<string>
    examples:
      - name: Example1
        value:
          id: ebfweufe922828
          length: 2
          width: 5
          height: 4
          weight: 1
          type: usps_flat_rate_envelope

  Recipient:
    docs: The information about the shipment recipient
    properties:
      address: Address
      name:
        docs: The recipient's name
        type: string
      email:
        docs: The recipient's email
        type: string
      phone:
        docs: The recipient's phone
        type: string
      contact_id:
        docs: The ID of the contact if one was used to create this recipient.
        type: string
    examples:
      - name: Example1
        value:
          name: Odin Oliver
          email: odin.oliver@packagex.io
          phone: "4844836699"
          contact_id: fwefwv28281
          address: $Address.Example2

  Sender:
    docs: The information about the shipment sender, which is normally the organization using this API
    properties:
      address: Address
      name:
        docs: The sender's name
        type: string
      email:
        docs: The sender's email
        type: string
      phone:
        docs: The sender's phone
        type: string
      contact_id:
        docs: The sender's unique packagex ID
        type: string
    examples:
      - name: Example1
        value:
          name: Jamie Jones
          email: jamie@packagex.io
          phone: "4844836699"
          contact_id: cwnwif2821
          address: $Address.Example1

  TrackingUpdate:
    docs: The record of each tracking update from a shipment
    properties:
      address: Address
      status: ShipmentStatus
      comment:
        docs: A shipping provider comment
        type: optional<string>
      images:
        docs: Urls of images
        type: list<string>
      message:
        docs: Human readable text explaining the status
        type: string
      event:
        docs: The event that occurred when this event was created. For all events see https://docs.packagex.io/shipments/events
        type: string
      created_at:
        docs: Time from unix eopch seconds when this tracking update was created
        type: integer
      updated_at:
        docs: The time in epoch seconds when this status was last updated
        type: integer
      location_id:
        docs: The ID of the location of this update, if it is one of your locations.
        type: optional<string>
      layout_id:
        docs: The ID of the layout that this item is on, if it matches one of your locations.
        type: optional<string>
    examples:
      - name: Example1
        value:
          address: $Address.Example1
          status: in_transit
          message: In Transit
          images: []
          created_at: 1679591515
          updated_at: 1679591623
          event: Your package is in transit
      - name: Example2
        value:
          address: $Address.Example1
          status: out_for_delivery
          message: Out for Delivery
          images: []
          created_at: 1679591515
          updated_at: 1679591623
          event: Your package is out for delivery

  Filters:
    docs: A sudo status given to the delivery to know what is happening with the delivery.
    enum:
      - completed
      - outstanding
      - exception

  RefundStatus:
    docs: The status of the refund on this shipment if one was requested
    enum:
      - requested
      - refunded
      - rejected

  ShipmentStatus:
    docs: The current status for the shipment. It's the same status as the latest tracking_update just surfaced for convenience. See https://docs.packagex.io/shipments/statuses for more info on statuses.
    enum:
      - rates_generated
      - created
      - address_issue
      - provider_at_pickup
      - contact_provider
      - delayed
      - delivery_attempted
      - delivery_rescheduled
      - delivery_scheduled
      - out_for_delivery
      - package_accepted
      - package_at_waypoint
      - in_transit
      - pickup_available
      - provider_at_dropoff
      - package_damaged
      - delivered
      - return_to_sender
      - package_undeliverable
      - package_lost
      - canceled

  RateTypes:
    docs: The type of rate that should be returned for the shipment.
    enum:
      - in_person_pickup
      - curbside_pickup
      - locker_pickup
      - provider_delivery
      - offline_delivery

  Options:
    docs: Options that were passed in when generated shipping rates.
    properties:
      provider_timeout:
        docs: The amount of time in milliseconds to wait for a shipping provider before discarding it's results.
        type: integer
      verify_address:
        docs: If all addresses for the shipment should be verified
        type: boolean
      checkout_total:
        docs: The total price in USD cents for the cart total during an e-commerce purchase.
        type: integer
      request_provider_pickup:
        docs: If the shipping provider should pick up this package.
        type: boolean
      providers:
        docs: The list of shipping provider IDs that you want returned.
        type: list<string>
      service_levels:
        docs: The list of service level IDs that you want returned.
        type: list<string>
      max_delivery_days:
        docs: The maximum number of delivery days for this shipment.
        type: integer
      rate_types: RateTypes

  Shipment:
    docs: A shipment object
    properties:
      amount:
        docs: The amount that will be collected from a customer. This includes any upcharges or discounts you have added to the price on the PackageX Dashboard.
        type: optional<integer>
      billed_amount:
        docs: The amount that your organization will be billed for this rate.
        type: optional<integer>
      provider:
        type: optional<Provider>
      created_at:
        docs: Time in epoch seconds when this shipment was created.
        type: integer
      updated_at:
        docs: Time in epoch seconds when this shipment was last updated.
        type: integer
      currency: Currency
      estimated_delivery:
        docs: Time in epoch seconds when we estimate the delivery will occur.
        type: optional<integer>
      filters: list<Filters>
      fulfillment_id:
        docs: The ID of the fulfillment that created this shipment.
        type: string
      id:
        docs: The unique ID for the shipment
        type: string
      refund_status: optional<RefundStatus>
      status: ShipmentStatus
      lead_time_mins:
        docs: The amount of lead time needed to prepare the shipment for an on-demand courier. This is only applicable for same-day shipments and indicated how much advance notice is required between the shipping provider and sender before a courier will be dispatched.
        type: integer
      metadata:
        docs: Custom key value pairs that the organization is able to add to this shipment
        type: optional<map<string, unknown>>
      options: optional<Options>
      paid:
        docs: If the shipment has been paid for
        type: boolean
      parcels:
        docs: The individual packages that are part of this shipment.
        type: list<Parcel>
      payment_reference:
        docs: A user generated reference for this payment. Will be included in invoices.
        type: optional<string>
      purchased_rate: optional<Rate>
      rates:
        docs: All of the rates that were returned when creating this shipment
        type: list<Rate>
      recipient: Recipient
      sender: Sender
      pickup_at:
        docs: Seconds from epoch when this shipment will be picked up, if pickup is part of the rate's service level
        type: optional<integer>
      organization_id:
        docs: The ID of the organization that owns this shipment
        type: string
      label_url:
        docs: The url for the shipping label
        type: optional<string>
      invoice_id:
        docs: The ID of the invoice for this shipment
        type: string
      kiosk_id:
        docs: This kiosk that was used to generate this shipment.
        type: string
      tracking_number:
        docs: The tracking number for this shipment.
        type: string
      tracking_url:
        docs: The url for the end user to track their shipment
        type: string
      feedback: optional<ShipmentFeedback>
      tracking_updates:
        docs: A list of all tracking updates that occurred for this shipment from oldest to newest
        type: list<TrackingUpdate>
      coordinates: list<double>
      _search: optional<Search>
    examples:
      - name: Example1
        value:
          amount: 1324
          billed_amount: 1023
          provider: $Provider.Example1
          created_at: 1679245915
          updated_at: 1679245933
          currency: usd
          estimated_delivery: 1679591515
          filters: [completed]
          fulfillment_id: efewifb31221
          id: defbei39dkna
          status: out_for_delivery
          lead_time_mins: 13
          paid: true
          parcels: [$Parcel.Example1]
          purchased_rate: $Rate.Example1
          rates: [$Rate.Example1]
          recipient: $Recipient.Example1
          sender: $Sender.Example1
          organization_id: dwndiwqe22en2
          invoice_id: verwdwdwq3j33x2
          kiosk_id: fcewueek9393
          tracking_number: wefewfwecn290ioieqoi1221239
          tracking_url: https://www.ups.com/track?loc=en_US&requester=ST/
          tracking_updates: [$TrackingUpdate.Example1, $TrackingUpdate.Example2]
          coordinates: [37.7749, 122.4194]

  ShipmentFeedback:
    docs: User provided feedback for this shipment
    properties:
      rating: optional<FeedbackRating>
      comment:
        docs: A comment that the user provided about their experience
        type: optional<string>
      updated_at:
        docs: When the feedback was updated in epoch seconds
        type: optional<integer>

  FeedbackRating:
    type: integer

  Currency:
    docs: The currency used for this shipment.
    enum:
      - usd

  Search:
    docs: A special property that will be included if searching through shipments.
    properties:
      id:
        docs: The ID of the shipment.
        type: string
      tracking_number:
        docs: The tracking number.
        type: string
      sender_name:
        docs: The sender's name. It will also match common nicknames.
        type: string
      sender_email:
        docs: The sender's email.
        type: string
      sender_phone:
        docs: The sender's phone.
        type: string
      sender_formatted_address:
        docs: The sender's full address string.
        type: string
      recipient_name:
        docs: The recipient's name. It will also match common nicknames.
        type: string
      recipient_email:
        docs: The recipient's email.
        type: string
      recipient_phone:
        docs: The recipient's phone.
        type: string
      recipient_formatted_address:
        docs: The recipient's full address string.
        type: string
      provider_name:
        docs: The shipping provider's name.
        type: string
      provider_id:
        docs: The shipping provider's ID
        type: string
      metadata:
        docs: Any custom metadata that you have added
        type: optional<map<string, unknown>>
      relevance_score:
        docs: A number from 0 - 1 about how relevant the result was to the search query, with 1 being a perfect match.
        type: double

  Error:
    docs: An error response
    properties:
      status:
        docs: A 4XX or 5XX status code indicating the error that occurred
        type: integer
      message:
        docs: A human readable message to display to an end user
        type: string
      error_code:
        type: string
        docs: The developer code for the issue that occurred.
      data:
        type: optional<map<string, unknown>>
        docs: The data object will be empty on errors
      errors:
        docs: An list of errors that occurred. Normally will be of the properties that failed validation.
        type: list<string>
      pagination: Pagination
      events:
        docs: All of the events that were triggered due to this request
        type: list<string>
      endpoint:
        docs: The endpoint that was hit
        type: string
